<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Records - Arend Theorem Prover</title>
<meta name="description" content="The Arend Theorem Prover">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Arend Theorem Prover">
<meta property="og:title" content="Records">
<meta property="og:url" content="https://arend-lang.github.io/documentation/language-reference/definitions/records.html">













<link rel="canonical" href="https://arend-lang.github.io/documentation/language-reference/definitions/records.html">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Arend Theorem Prover Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">Arend Theorem Prover</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/documentation" >Documentation</a>
            </li><li class="masthead__menu-item">
              <a href="/download" >Download</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      



<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>

  
  
  
  

  
  
  

  <ul class="nav__items">
    
      <li>
        
          
          

          <a href="/documentation/getting-started"><span class="nav__sub-title">Getting Started</span></a>
        

        
      </li>
    
      <li>
        
          
          

          <a href="/documentation/language-reference"><span class="nav__sub-title">Language Reference</span></a>
        

        
        <ul>
          
            
            

            

            <li><a href="/documentation/language-reference/lexical-structure" class="">Lexical structure</a></li>

            
            
            
          
            
            

            

            <li><a href="/documentation/language-reference/definitions" class="">Definitions</a></li>

            
            
            
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/modules" class="">&nbsp;&nbsp;&nbsp;&nbsp;Modules</a></li>
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/parameters" class="">&nbsp;&nbsp;&nbsp;&nbsp;Parameters</a></li>
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/functions" class="">&nbsp;&nbsp;&nbsp;&nbsp;Functions</a></li>
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/data" class="">&nbsp;&nbsp;&nbsp;&nbsp;Data</a></li>
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/hits" class="">&nbsp;&nbsp;&nbsp;&nbsp;Higher inductive types</a></li>
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/records" class="active">&nbsp;&nbsp;&nbsp;&nbsp;Records</a></li>
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/classes" class="">&nbsp;&nbsp;&nbsp;&nbsp;Classes</a></li>
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/coercion" class="">&nbsp;&nbsp;&nbsp;&nbsp;Coercion</a></li>
              
                
                

                

                <li><a href="/documentation/language-reference/definitions/level" class="">&nbsp;&nbsp;&nbsp;&nbsp;Level</a></li>
              
            
          
            
            

            

            <li><a href="/documentation/language-reference/expressions" class="">Expressions</a></li>

            
            
            
          
            
            

            

            <li><a href="/documentation/language-reference/prelude" class="">Prelude</a></li>

            
            
            
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/documentation/libraries"><span class="nav__sub-title">Libraries</span></a>
        

        
      </li>
    
  </ul>
</nav>

    
  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Records">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Records
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Records</h4></header>
              <ul class="toc__menu">
  <li><a href="#properties">Properties</a></li>
  <li><a href="#extensions">Extensions</a></li>
  <li><a href="#this">This</a></li>
</ul>
            </nav>
          </aside>
        
        <p>A <em>record</em> is a <a href="../expressions/sigma">Sigma type</a> with named projections.
The basic syntax looks like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\record</span> R (p_1 <span class="o">:</span> A_1) ... (p_n <span class="o">:</span> A_n) {
  <span class="o">|</span> f_1 <span class="o">:</span> B_1
  ...
  <span class="o">|</span> f_k <span class="o">:</span> B_k
}</code></pre></div></div>

<p>where <span class="inl-highlight">f_1<span class="o">,</span> … f_k</span> and <span class="inl-highlight">p_1<span class="o">,</span> … p_n</span> are <em>fields</em> of <span class="inl-highlight">R</span>.
Note that records do not have parameters and <span class="inl-highlight">p_1<span class="o">,</span> … p_n</span> are also fields of <span class="inl-highlight">R</span>.
The only difference between <span class="inl-highlight">p_i</span> and <span class="inl-highlight">f_j</span> is that <span class="inl-highlight">f_j</span> are visible in the scope of <span class="inl-highlight">R</span> and <span class="inl-highlight">p_i</span> are not:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\func</span> test1 <span class="o">=&gt;</span> f_1
<span class="k">\func</span> test2 <span class="o">=&gt;</span> R.f_1
<span class="k">\func</span> test3 <span class="o">=&gt;</span> R.p_1

<span class="c">-- p_1 is not in scope in the following function:</span>
<span class="c">-- \func test4 =&gt; p_1</span></code></pre></div></div>

<p>It is also possible to write <span class="inl-highlight"><span class="k">\field</span> f_i <span class="o">:</span> B_i</span> instead of <span class="inl-highlight"><span class="o">|</span> f_i <span class="o">:</span> B_i</span>, but there is a difference between these notations, which is discussed <a href="#properties">below</a>.</p>

<p>Fields can be accessed using projection functions:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\func</span> test5 (x <span class="o">:</span> R) <span class="o">=&gt;</span> R.p_1 {x}
<span class="k">\func</span> test6 (x <span class="o">:</span> R) <span class="o">=&gt;</span> f_1 {x}</code></pre></div></div>

<p>An alternative way to access fields is provided by the following syntax:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\func</span> test5' (x <span class="o">:</span> R) <span class="o">=&gt;</span> x.p_1
<span class="k">\func</span> test6' (x <span class="o">:</span> R) <span class="o">=&gt;</span> x.f_1</code></pre></div></div>

<p>This syntax is allowed only when the expression before <span class="inl-highlight">.</span> is a variable with an explicitly specified type which is a record.
If <span class="inl-highlight">x <span class="o">:</span> R</span> and <span class="inl-highlight">f</span> is a field of <span class="inl-highlight">R</span>, then <span class="inl-highlight">x.f</span> is equivalent to <span class="inl-highlight">R.f {x}</span>.</p>

<p>The type <span class="inl-highlight">A_i</span> can depend on variables <span class="inl-highlight">p_1<span class="o">,</span> … p_{i-1}</span>.
The type <span class="inl-highlight">B_i</span> can depend on variables <span class="inl-highlight">p_1<span class="o">,</span> … p_n</span> and <span class="inl-highlight">f_1<span class="o">,</span> … f_{i-1}</span>.</p>

<p>Records are essentially Sigma types. For example, the record <span class="inl-highlight">R</span> above is equivalent to the Sigma type
<span class="inl-highlight"><span class="k">\Sigma</span> (p_1 <span class="o">:</span> A_1) … (p_n <span class="o">:</span> A_n) (f_1 <span class="o">:</span> B_1) … (f_k <span class="o">:</span> B_k)</span>.</p>

<p>Instances of type <span class="inl-highlight">R</span> can be created using <em>new expression</em>. Any of the variants of the syntax listed below can be used, they are all equivalent. 
See <a href="../expressions/class-ext">Class extensions</a> for more information about new expressions and related constructions.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\func</span> r1 <span class="o">=&gt;</span> <span class="k">\new</span> R a_1 ... a_n { <span class="o">|</span> f_1 <span class="o">=&gt;</span> b_1 ... <span class="o">|</span> f_k <span class="o">=&gt;</span> b_k }
<span class="k">\func</span> r2 <span class="o">=&gt;</span> <span class="k">\new</span> R { <span class="o">|</span> p_1 <span class="o">=&gt;</span> a_1 ... <span class="o">|</span> p_n <span class="o">=&gt;</span> a_n <span class="o">|</span> f_1 <span class="o">=&gt;</span> b_1 ... <span class="o">|</span> f_k <span class="o">=&gt;</span> b_k }
<span class="k">\func</span> r3 <span class="o">=&gt;</span> <span class="k">\new</span> R a_1 ... a_n b_1 ... b_k
<span class="k">\func</span> r4 <span class="o">=&gt;</span> <span class="k">\new</span> R a_1 ... a_i { <span class="o">|</span> p_{i+1} <span class="o">=&gt;</span> a_{i+1} ... <span class="o">|</span> p_n <span class="o">=&gt;</span> a_n <span class="o">|</span> f_1 <span class="o">=&gt;</span> b_1 ... <span class="o">|</span> f_k <span class="o">=&gt;</span> b_k }
<span class="k">\func</span> r5 <span class="o">=&gt;</span> <span class="k">\new</span> R a_1 ... a_n b_1 ... b_i { f_{i+1} <span class="o">=&gt;</span> b_{i+1} ... <span class="o">|</span> f_k <span class="o">=&gt;</span> b_k }</code></pre></div></div>

<p>The same function can also be defined using <a href="functions/#copattern-matching">copattern matching</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\func</span> r6 <span class="o">:</span> R <span class="k">\cowith</span>
  <span class="o">|</span> p_1 <span class="o">=&gt;</span> a_1
  ...
  <span class="o">|</span> p_n <span class="o">=&gt;</span> a_n
  <span class="o">|</span> f_1 <span class="o">=&gt;</span> b_1
  ...
  <span class="o">|</span> f_k <span class="o">=&gt;</span> b_k</code></pre></div></div>

<p>Records satisfy the eta rule.
This means that the expression <span class="inl-highlight"><span class="k">\new</span> R r.p_1 … r.p_n r.f_1 … r.f_k</span> is equivalent to <span class="inl-highlight">r</span>.</p>

<h2 id="properties">Properties</h2>

<p>Some fields can be marked as a <em>property</em>.
This is done by using the keyword <span class="inl-highlight"><span class="k">\property</span></span> instead of <span class="inl-highlight"><span class="k">\field</span></span>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\record</span> NegativeInt {
  <span class="k">\field</span> x <span class="o">:</span> Int
  <span class="k">\property</span> isNeg <span class="o">:</span> x &lt; <span class="n">0</span>
}</code></pre></div></div>

<p>The type of a property must be a proposition, otherwise the definition does not typecheck.</p>

<p>If <span class="inl-highlight">A</span> is a proposition, then <span class="inl-highlight"><span class="o">|</span> f <span class="o">:</span> A</span> is also marked as a property. In this case, <span class="inl-highlight">f</span> can be defined as a
normal field, which is not a property, by writing <span class="inl-highlight"><span class="k">\field</span> f <span class="o">:</span> A</span>.</p>

<p>Properties do not evaluate.
Thus, they are related to fields in the same way as <a href="functions/#lemmas">lemmas</a> are related to functions.
For example, consider the following function:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\func</span> test (x <span class="o">:</span> Int) (p <span class="o">:</span> x &lt; <span class="n">0</span>) <span class="o">=&gt;</span> isNeg {<span class="k">\new</span> NegativeInt x p}</code></pre></div></div>

<p>Then <span class="inl-highlight">test x p</span> evaluates to <span class="inl-highlight">p</span> if <span class="inl-highlight">isNeg</span> is not a property and does not evaluate if it is.</p>

<h2 id="extensions">Extensions</h2>

<p>An extension <span class="inl-highlight">S</span> of a record <span class="inl-highlight">R</span> is another record which adds some fields to <span class="inl-highlight">R</span> and implements some of the fields of <span class="inl-highlight">R</span>.
The record <span class="inl-highlight">R</span> is called a <em>super class</em> of <span class="inl-highlight">S</span> and <span class="inl-highlight">S</span> is called a <em>subclass</em> of <span class="inl-highlight">R</span>.
If <span class="inl-highlight">R</span> is the definition of a record from the beginning of this page, then an extension <span class="inl-highlight">S</span> of <span class="inl-highlight">R</span> can be defined as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\record</span> S (r_1 <span class="o">:</span> D_1) ... (r_t <span class="o">:</span> D_t) <span class="k">\extends</span> R {
  <span class="o">|</span> g_1 <span class="o">:</span> C_1
  ...
  <span class="o">|</span> g_m <span class="o">:</span> C_m
  <span class="o">|</span> p_{i_1} <span class="o">=&gt;</span> a_{i_1}
  ...
  <span class="o">|</span> p_{i_q} <span class="o">=&gt;</span> a_{i_q}
  <span class="o">|</span> f_{j_1} <span class="o">=&gt;</span> b_{j_1}
  ...
  <span class="o">|</span> f_{j_s} <span class="o">=&gt;</span> b_{j_s}
}</code></pre></div></div>

<p>Here expressions <span class="inl-highlight">a_i</span> and <span class="inl-highlight">b_j</span> have types <span class="inl-highlight">A_i</span> and <span class="inl-highlight">B_j</span> respectively.
Expressions <span class="inl-highlight">a_i</span> and <span class="inl-highlight">b_j</span> may refer to any field of <span class="inl-highlight">S</span>, but implementations must not form a cycle.</p>

<p>The type <span class="inl-highlight">S</span> is a subtype of <span class="inl-highlight">R</span>. That is, every expression of type <span class="inl-highlight">S</span> is also of type <span class="inl-highlight">R</span>.</p>

<p>A record is equivalent to the Sigma type, consisting of all of its unimplemented fields.
For example, consider the following records:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\record</span> C (x y <span class="o">:</span> Nat) {
  <span class="o">|</span> x&lt;=y <span class="o">:</span> x &lt;= y
  <span class="o">|</span> y&lt;=0 <span class="o">:</span> y &lt;= <span class="n">0</span>
}

<span class="k">\record</span> D <span class="k">\extends</span> C {
  <span class="o">|</span> y <span class="o">=&gt;</span> x
  <span class="o">|</span> x&lt;=y <span class="o">=&gt;</span> &lt;=-reflexive x
}</code></pre></div></div>

<p>Then <span class="inl-highlight">D</span> is equivalent to <span class="inl-highlight"><span class="k">\Sigma</span> (x <span class="o">:</span> Nat) (x &lt;= <span class="n">0</span>)</span>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\func</span> fromD (d <span class="o">:</span> D) <span class="o">:</span> <span class="k">\Sigma</span> (x <span class="o">:</span> Nat) (x &lt;= <span class="n">0</span>) <span class="o">=&gt;</span> (d.x<span class="o">,</span> d.y&lt;=0)
<span class="k">\func</span> toD (p <span class="o">:</span> <span class="k">\Sigma</span> (x <span class="o">:</span> Nat) (x &lt;= <span class="n">0</span>)) <span class="o">=&gt;</span> <span class="k">\new</span> D p.<span class="n">1</span> p.<span class="n">2</span>
<span class="k">\func</span> fromToD (d <span class="o">:</span> D) <span class="o">:</span> toD (fromD d) <span class="o">=</span> d <span class="o">=&gt;</span> idp
<span class="k">\func</span> toFromD (p <span class="o">:</span> <span class="k">\Sigma</span> (x <span class="o">:</span> Nat) (x &lt;= <span class="n">0</span>)) <span class="o">:</span> fromD (toD p) <span class="o">=</span> p <span class="o">=&gt;</span> idp</code></pre></div></div>

<p>where <span class="inl-highlight">idp</span> is the proof by reflexivity.
This works since both records and Sigma types satisfy eta rules.</p>

<p>A record can extend several records.
If these records extend some base record themselves, then the fields of this base record will not be repeated in the final record.
For example, consider the following records:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\record</span> A (x <span class="o">:</span> Nat)
<span class="k">\record</span> B <span class="k">\extends</span> A
<span class="k">\record</span> C <span class="k">\extends</span> A
<span class="k">\record</span> D <span class="k">\extends</span> B<span class="o">,</span>C</code></pre></div></div>

<p>Then <span class="inl-highlight">D</span> has a single field <span class="inl-highlight">x</span>.
If super classes have fields with the same name which are not defined in some common super class, then the final record
will have several different fields with the same name.
In order to access these fields, fully qualified names should be used:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\record</span> B (x <span class="o">:</span> Nat)
<span class="k">\record</span> C (x <span class="o">:</span> Nat)
<span class="k">\record</span> D <span class="k">\extends</span> B<span class="o">,</span>C

<span class="k">\func</span> fromD (d <span class="o">:</span> D) <span class="o">:</span> <span class="k">\Sigma</span> Nat Nat <span class="o">=&gt;</span> (B.x {d}<span class="o">,</span> C.x {d})
<span class="k">\func</span> toD (p <span class="o">:</span> <span class="k">\Sigma</span> Nat Nat) <span class="o">=&gt;</span> <span class="k">\new</span> D p.<span class="n">1</span> p.<span class="n">2</span>
<span class="k">\func</span> fromToD (d <span class="o">:</span> D) <span class="o">:</span> toD (fromD d) <span class="o">=</span> d <span class="o">=&gt;</span> idp
<span class="k">\func</span> toFromD (p <span class="o">:</span> <span class="k">\Sigma</span> Nat Nat) <span class="o">:</span> fromD (toD p) <span class="o">=</span> p <span class="o">=&gt;</span> idp</code></pre></div></div>

<h2 id="this">This</h2>

<p>Every field of a record <span class="inl-highlight">R</span> has additional implicit parameter of type <span class="inl-highlight">R</span>, which can be referred to with the keyword <span class="inl-highlight"><span class="k">\this</span></span>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\record</span> R (X <span class="o">:</span> <span class="kt">\Type</span>) (t <span class="o">:</span> X <span class="o">-&gt;</span> X)

<span class="k">\func</span> f (r <span class="o">:</span> R) <span class="o">=&gt;</span> r.t

<span class="k">\record</span> S <span class="k">\extends</span> R {
  <span class="o">|</span> x <span class="o">:</span> X
  <span class="o">|</span> p <span class="o">:</span> f <span class="k">\this</span> x <span class="o">=</span> x
}</code></pre></div></div>

<p>The keyword <span class="inl-highlight"><span class="k">\this</span></span> can appear only in arguments of definitions and only in those arguments, which in turn satisfy this condition.</p>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/JetBrains/Arend" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://twitter.com/ArendLang" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i> Twitter</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Arend. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>










  </body>
</html>
